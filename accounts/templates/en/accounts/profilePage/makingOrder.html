{% load static %}
{% load mathfilters %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet"  href="{%  static  'shop/css/main/style.css'  %}">
    <link rel="stylesheet"  href="{%  static  'shop/css/accounts/profile/profile_style.css'  %}">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Syne+Mono&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <link href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" rel="stylesheet">
    <title>Making order</title>
    <script>
        function pickup(){
            document.getElementById('address').style.display ='none';
            document.getElementById('np').style.display ='none';
            document.getElementById('up').style.display ='none';
        }
        function novapochta(){
            document.getElementById('address').style.display ='block';
            document.getElementById('nova').style.display ='block';
            document.getElementById('ukr').style.display ='none';
        }
        function ukrpochta(){
            document.getElementById('address').style.display ='block';
            document.getElementById('nova').style.display ='none';
            document.getElementById('ukr').style.display ='block';
        }
    </script>
</head>
<body>
    {% include 'en/accounts/profilePage/includes/navbar.html' %}
    {% if userId == account %}
    {{ error_message }}
    <div>
        <form method="POST" action="">
            {% csrf_token %}
            <label>First name: </label><input type='text' name='first_name' value='{{ user.first_name }}' placeholder="Enter your first name" required>
            <label>Last name: </label><input type='text' name='last_name' value='{{ user.last_name }}' placeholder="Enter your last name" required>
            <label>Email: </label><input type='text' name='email' value='{{ user.email }}'placeholder="Enter your email">
            {% if user.phone_number != None %}
            <label>Phone number: </label><input type='text' name='phone_number' value='{{ user.phone_number }}' placeholder="Enter your phone number" required>
            {% else %}
            <label>Phone number: </label><input type='text' name='phone_number' placeholder="Enter your phone number" required>
            {% endif %}
            <br>
            <label>Order: </label>
            <div style='display: none;'>
                <input type="hidden" value='{{ userCart.name }}' name='order'>
            </div>
            {% for i in userCart %}
            {% if i.currency == 'UAH' %}
                <p>{{ i.name }} Price: {{ i.price|floatformat:"2" }}UAH</p>
            {% else %}
                <p>{{ i.name }} Price: {{ i.price|mul:currency|floatformat:"2" }}UAH</p>   
            {% endif %}
            {% endfor %}
            <div style='display: none;'>
                <input type="hidden" value='{{ price }}' name='price'>
            </div>
            <div style='display: none;'>
                <input type="submit" name='quit' id='quit'>
            </div>
            <p>Total price: {{ price|floatformat:"2" }} UAH</p>
            <p style='color: red !important; text-decoration: underline;'>Attention! If you leave this page, the order will not be confirmed and will be deleted after 30 minutes!</p>
            <p>Delivery Type: </p>
            <input type="radio" name='typeOfDelivery' value='Самовывоз' onclick="pickup();" checked>                
            <label>By yourself</label>
            <br>
            <input type="radio" name='typeOfDelivery' value='Нова Пошта' onclick='novapochta();'>
            <label>Nova Poshta</label>
            <br>
            <input type="radio" name='typeOfDelivery' value='Укрпошта' onclick='ukrpochta();'>
            <label>Ukrposhta</label>
            <br>
            <p>Payment Type: </p>
            <input type="radio" name='typeOfPayment' value='Наличный' checked>
            <label>Cash</label>
            <br>
            <input type="radio" name='typeOfPayment_NOTWORKING' id='cardpay' value='Безналичный' disabled>
            <label>Card</label><label style="color: red;"> Unavailable (in development)</label>
            <div id='address' style='display: none;'>
                <p>Address</p>
                <div id='nova' style='display: none;'><label>Nova Poshta department: </label><input type='text' name='nova_pochta' value='{{ user.nova_pochta }}'></div>
                <div id='ukr' style='display: none;'><label>Ukrposhta index: </label><input type='number' name='ukr_pochta' value='{{ user.ukr_pochta }}'></div>
                <label>City: </label><input type='text' name='city' value='{{ user.city }}'>
                <label>Street: </label><input type='text' name='street' value='{{ user.street }}'>
                <label>House: </label><input type='text' name="house" value='{{ user.house }}'>
            </div>
            <br>
            <input type="submit" name='go' value="Make an order!">
        </form>
    </div>
    {% else %}
    <h1 style="text-align: center; margin-top: 50px; margin-bottom: 50px;">404<br><a href='/en' style="text-decoration: underline; color: blue !important;">Go Back!</a></h1>
    {% endif %}
    {% include 'en/accounts/profilePage/includes/footer.html' %}
    <script>
        window.onbeforeunload = closingCode;
            function closingCode(){
            document.getElementById("quit").submit();
            return null; //<-- this prevents the dialog confirm box
        }
    </script>
</body>
</html>
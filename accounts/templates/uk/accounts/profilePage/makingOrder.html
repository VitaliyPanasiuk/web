{% load static %}
{% load mathfilters %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet"  href="{%  static  'shop/css/main/style.css'  %}">
    <link rel="stylesheet"  href="{%  static  'shop/css/accounts/profile/profile_style.css'  %}">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Syne+Mono&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <link href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" rel="stylesheet">
    <title>Створити замовлення</title>
    <script>
        function pickup(){
            document.getElementById('address').style.display ='none';
            document.getElementById('np').style.display ='none';
            document.getElementById('up').style.display ='none';
        }
        function novapochta(){
            document.getElementById('address').style.display ='block';
            document.getElementById('nova').style.display ='block';
            document.getElementById('ukr').style.display ='none';
        }
        function ukrpochta(){
            document.getElementById('address').style.display ='block';
            document.getElementById('nova').style.display ='none';
            document.getElementById('ukr').style.display ='block';
        }
    </script>
</head>
<body>
    {% include 'uk/accounts/profilePage/includes/navbar.html' %}
    {% if userId == account %}
    {{ error_message }}
    <div>
        <form method="POST" action="">
            {% csrf_token %}
            <label>Ім'я: </label><input type='text' name='first_name' value='{{ user.first_name }}' placeholder="Введіть Ваше ім'я" required>
            <label>Прізвище: </label><input type='text' name='last_name' value='{{ user.last_name }}' placeholder="Введіть Ваше прізвище" required>
            <label>Електронна пошта: </label><input type='text' name='email' value='{{ user.email }}'placeholder="Введите Ваш email">
            {% if user.phone_number != None %}
            <label>Телефон: </label><input type='text' name='phone_number' value='{{ user.phone_number }}' placeholder="Введіть Ваш номер телефону" required>
            {% else %}
            <label>Телефон: </label><input type='text' name='phone_number' placeholder="Введіть Ваш номер телефону" required>
            {% endif %}
            <br>
            <label>Замовлення: </label>
            <div style='display: none;'>
                <input type="hidden" value='{{ userCart.name }}' name='order'>
            </div>
            {% for i in userCart %}
            {% if i.currency == 'UAH' %}
                <p>{{ i.name }} Цена: {{ i.price|floatformat:"2" }}UAH</p>
            {% else %}
                <p>{{ i.name }} Цена: {{ i.price|mul:currency|floatformat:"2" }}UAH</p>   
            {% endif %}
            {% endfor %}
            <div style='display: none;'>
                <input type="hidden" value='{{ price }}' name='price'>
            </div>
            <div style='display: none;'>
                <input type="submit" name='quit' id='quit'>
            </div>
            <p>До сплати: {{ price|floatformat:"2" }} UAH</p>
            <p style='color: red !important; text-decoration: underline;'>Увага! При виході з цієї сторінки без оформлення замовлення, воно не будт підтверджено та автоматично буде видалено через 30 хвилин!</p>
            <p>Тип доставки: </p>
            <input type="radio" name='typeOfDelivery' value='Самовывоз' onclick="pickup();" checked>                
            <label>Самовивіз</label>
            <br>
            <input type="radio" name='typeOfDelivery' value='Нова Пошта' onclick='novapochta();'>
            <label>Нова Пошта</label>
            <br>
            <input type="radio" name='typeOfDelivery' value='Укрпошта' onclick='ukrpochta();'>
            <label>Укрпошта</label>
            <br>
            <p>Тип оплаты: </p>
            <input type="radio" name='typeOfPayment' value='Наличный' checked>
            <label>Готівка</label>
            <br>
            <input type="radio" name='typeOfPayment_NOTWORKING' id='cardpay' value='Безналичный' disabled>
            <label>Картка</label><label style="color: red;"> Недоступно (в розробці)</label>
            <div id='address' style='display: none;'>
                <p>Адреса</p>
                <div id='nova' style='display: none;'><label>Відділення Нової Пошти: </label><input type='text' name='nova_pochta' value='{{ user.nova_pochta }}'></div>
                <div id='ukr' style='display: none;'><label>Поштовий індекс: </label><input type='number' name='ukr_pochta' value='{{ user.ukr_pochta }}'></div>
                <label>Місто: </label><input type='text' name='city' value='{{ user.city }}'>
                <label>Вулиця: </label><input type='text' name='street' value='{{ user.street }}'>
                <label>Дім: </label><input type='text' name="house" value='{{ user.house }}'>
            </div>
            <br>
            <input type="submit" name='go' value="Створити замовлення!">
        </form>
    </div>
    {% else %}
    <h1 style="text-align: center; margin-top: 50px; margin-bottom: 50px;">404<br><a href='/uk' style="text-decoration: underline; color: blue !important;">Повернутися на головну!</a></h1>
    {% endif %}
    {% include 'uk/accounts/profilePage/includes/footer.html' %}
    <script>
        window.onbeforeunload = closingCode;
            function closingCode(){
            document.getElementById("quit").submit();
            return null; //<-- this prevents the dialog confirm box
        }
    </script>
</body>
</html>